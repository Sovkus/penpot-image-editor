<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Editor</title>
</head>
<body>
    <h1>Image Editor Plugin</h1>
    <p>Select an image in Penpot to edit it.</p>
    
    <div style="margin: 20px 0;">
        <button id="testBtn">Test Button</button>
    </div>
    
    <div id="status"></div>

    <script>
        // Минимальный рабочий скрипт
        console.log("=== Image Editor Plugin Started ===");
        
        // Получаем элементы
        const testBtn = document.getElementById('testBtn');
        const statusDiv = document.getElementById('status');
        
        // Простая функция для отображения статуса
        function showStatus(message, isError = false) {
            if (statusDiv) {
                statusDiv.textContent = message;
                statusDiv.style.color = isError ? 'red' : 'green';
                statusDiv.style.marginTop = '10px';
            }
            console.log("Status:", message);
        }
        
        // Обработчик кнопки
        if (testBtn) {
            testBtn.addEventListener('click', function() {
                showStatus("Button clicked! Plugin is working.");
            });
        }
        
        // Сообщаем Penpot, что плагин готов
        window.addEventListener('load', function() {
            console.log("Plugin window loaded");
            showStatus("✅ Plugin loaded successfully");
            
            // Отправляем сообщение в Penpot
            try {
                if (window.parent) {
                    window.parent.postMessage({
                        type: 'plugin-ready',
                        source: 'image-editor',
                        version: '1.0.0'
                    }, '*');
                    console.log("Sent 'plugin-ready' message to Penpot");
                }
            } catch (error) {
                console.error("Error sending message:", error);
            }
        });
        
        // Обработчик сообщений от Penpot
        window.addEventListener('message', function(event) {
            console.log("Message received from Penpot:", event.data);
            
            // Можно добавить обработку сообщений позже
            if (event.data && event.data.type) {
                showStatus(`Got message: ${event.data.type}`);
            }
        });
        
        console.log("=== Plugin Initialization Complete ===");
    </script>
</body>
</html>
